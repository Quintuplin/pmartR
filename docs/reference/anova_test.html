<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Tests for a quantiative difference between groups (aka factors, aka main effects) — anova_test • pmartR</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Tests for a quantiative difference between groups (aka factors, aka main effects) — anova_test" />

<meta property="og:description" content="This is the ANOVA part of the IMD-ANOVA test proposed in Webb-Robertson et al. (2010)." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmartR</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Quality_Control_with_pmartR.html">Quality Control of Peptide Data with the `pmartR` Package</a>
    </li>
    <li>
      <a href="../articles/Statistical_Analysis_with_pmartR.html">Statistical Analysis with the `pmartR` Package</a>
    </li>
    <li>
      <a href="../articles/analysis_log.html">analysis_log</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/pmartR/pmartR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Tests for a quantiative difference between groups (aka factors, aka main effects)</h1>
    <small class="dont-index">Source: <a href='https://github.com/pmartR/pmartR/blob/master/R/anova_test.R'><code>R/anova_test.R</code></a></small>
    <div class="hidden name"><code>anova_test.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This is the ANOVA part of the IMD-ANOVA test proposed in Webb-Robertson et al. (2010).</p>
    
    </div>

    <pre class="usage"><span class='fu'>anova_test</span>(<span class='no'>omicsData</span>, <span class='kw'>comparisons</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>pval_adjust</span> <span class='kw'>=</span> <span class='st'>"none"</span>,
  <span class='kw'>pval_thresh</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>covariates</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>paired</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>equal_var</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>omicsData</th>
      <td><p>A pmartR data object of any class</p></td>
    </tr>
    <tr>
      <th>comparisons</th>
      <td><p>data.frame with columns for "Control" and "Test" containing the different comparisons of interest. Comparisons will be made between the Test and the corresponding Control  If left NULL, then all pairwise comparisons are executed.</p></td>
    </tr>
    <tr>
      <th>pval_adjust</th>
      <td><p>character vector specifying the type of multiple comparisons adjustment to implement. An unspecified value corresponds to no adjustment. Valid options include: holm, bonferroni, Tukey, Dunnett, none.</p></td>
    </tr>
    <tr>
      <th>pval_thresh</th>
      <td><p>numeric p-value threshold, below or equal to which peptides are considered differentially expressed. Defaults to 0.05</p></td>
    </tr>
    <tr>
      <th>covariates</th>
      <td><p>data.frame similar to <code>groupData</code> consisting of two columsn: the sample ID variable (with names matching column names in <code>omicsData$e_data</code>) and a column containing the numeric or group data for each sample</p></td>
    </tr>
    <tr>
      <th>paired</th>
      <td><p>logical; should the data be paired or not? if TRUE then the `f_data` element of `omicsData` is checked for a "Pair" column, an error is returned if none is found</p></td>
    </tr>
    <tr>
      <th>equal_var</th>
      <td><p>logical; should the variance across groups be assumed equal?</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list of `data.frame`s</p><table class='table'>
<tr><td>Results</td><td>Edata cname, Variance Estimate, ANOVA F-Statistic, ANOVA p-value, Group means</td></tr>
<tr><td></td><td></td></tr>
<tr><td>Fold_changes</td><td>Estimated fold-changes for each comparison</td></tr>
<tr><td></td><td></td></tr>
<tr><td>Fold_changes_pvalues</td><td>P-values corresponding to the fold-changes for each comparison</td></tr>
<tr><td></td><td></td></tr>
<tr><td>Fold_change_flags</td><td>Indicator of statistical significance (0/+-2 to if adjusted p-value&gt;=pval_thresh or p-value&lt;pval_thresh)</td></tr>
<tr><td></td><td>Results</td></tr>
</table>


    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The order in which different scenarios are handeled:</p><ol>
<li><p>If the data are paired, then the pairing is accounted for first then each of the next steps is carried out on the new variable that is 
 the difference in the paired individuals.&lt;br&gt;</p></li>
<li><p>If covariates are provided, their effect is removed before testing for group differences though mathematically covariates and grouping 
 effects are accounted for simultaneously</p></li>
<li><p>ANOVA is executed to assess the effect of each main effects, results in a vector of group means for each biomolecule and variance estimate</p></li>
<li><p>Group comparisons defined by `comaprison` argument are implemented use parameter vector and variance estimates in ANOVA step</p></li>
</ol>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Webb-Robertson, Bobbie-Jo M., et al. "Combined statistical analyses of peptide intensities and peptide occurrences improves identification of significant peptides from MS-based proteomics data." Journal of proteome research 9.11 (2010): 5748-5756.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>dontrun{
library(pmartRdata)
library(pmartR)
mypepData <- edata_transform(omicsData = pep_object, data_scale = "log2")
mypepData <- group_designation(omicsData = mypepData, main_effects = c("Condition"))

#Try running anova_test without filtering, should get warning because the data haven't been filtered yet
anova_res <- anova_test(omicsData = mypepData) 

#Now filter and run again
imdanova_Filt <- imdanova_filter(omicsData = mypepData)
mypepData <- applyFilt(filter_object = imdanova_Filt, omicsData = mypepData, min_nonmiss_anova=2)
anova_res <- anova_test(omicsData = mypepData)
anova_res_tukey <- anova_test(omicsData = mypepData, pval_adjust = 'tukey') 
#Should be equivalent to above since only making one comparison
all(anova_res$Comparison==anova_res_tukey$Comparisons)

#If group IDs are treated as a covariate, all of the fold changes should be zero
covars <- attr(mypepData, "group_DF")
colnames(covars)[2] <- "Gp"
anova_res <- anova_test(omicsData = mypepData, covariates = covars)
summary(anova_res$Fold_changes)

#Test with really big dataset, one factor
library(OvarianPepdataBPsubset)
tcga_ovarian_pepdata_bp <- as.pepData(e_data = tcga_ovarian_pepdata_bp_subset$e_data, f_data = tcga_ovarian_pepdata_bp_subset$f_data, e_meta = tcga_ovarian_pepdata_bp_subset$e_meta, edata_cname = "Peptide", fdata_cname = "sampleID", emeta_cname = "Protein", check.names = FALSE)
tcga_ovarian_pepdata_bp <- group_designation(omicsData = tcga_ovarian_pepdata_bp, main_effects = c("vital_status"))
tcga_ovarian_pepdata_bp <- edata_transform(tcga_ovarian_pepdata_bp, "log2")
imdanova_Filt <- imdanova_filter(omicsData = tcga_ovarian_pepdata_bp)
tcga_ovarian_pepdata_bp <- applyFilt(filter_object = imdanova_Filt, omicsData = tcga_ovarian_pepdata_bp, min_nonmiss_anova=2)
ovarian_res <- anova_test(omicsData = tcga_ovarian_pepdata_bp) 
#Tukey adjustment is super slow right now because "ptukey" is super slow, not sure how to fix that
ovarian_res_tukey <- anova_test(omicsData = tcga_ovarian_pepdata_bp, pval_adjust = 'tukey') 
#Dunnett adjustment, super slow because mvtnorm::pmvt is super slow
ovarian_res_dunnett <- anova_test(omicsData = tcga_ovarian_pepdata_bp, pval_adjust = 'dunnett') 

#Test really big dataset, two factors, all pairwise comparisons
tcga_ovarian_pepdata_bp <- group_designation(omicsData = tcga_ovarian_pepdata_bp, main_effects = c("vital_status","neoplasm_histologic_grade"))
ovarian_res_twofac <- anova_test(omicsData = tcga_ovarian_pepdata_bp)

#Same but only test main effects (Dead vs Alive, G2 vs G3)
comp_df <- data.frame(Control=c("Alive","G2"), Test=c("Dead","G3"))
ovarian_res_twofac_main_effects <- anova_test(omicsData = tcga_ovarian_pepdata_bp, comparisons = comp_df)

#Same but only test arbitrary diagonal effects (Dead_G2 vs Alive_G3, Alive_G2 vs Alive_G3)
comp_df <- data.frame(Control=c("Dead_G2","Alive_G2"), Test=c("Alive_G3","Alive_G3"))
ovarian_res_twofac_arb_effects <- anova_test(omicsData = tcga_ovarian_pepdata_bp, comparisons = comp_df)
}
</div><div class='output co'>#&gt; <span class='error'>Error: &lt;text&gt;:1:8: unexpected '{'</span>
#&gt; <span class='error'>1: dontrun{</span>
#&gt; <span class='error'>           ^</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Bryan Stanfill

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by .</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

